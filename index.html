<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>√éle-de-Sons</title>

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <!-- CSS -->
  <link rel="stylesheet" href="./styles.css" />
</head>

<body>
  <div class="app">

    <!-- TOP BAR (overlay) -->
    <header class="topbar">
      <div class="brand">
        <!-- Mets ton logo dans le dossier : logo.png -->
        <img class="brand-logo" src="./logo.png" alt="√éle-de-Sons" onerror="this.style.display='none'">
        <div class="brand-text">
          <div class="brand-title">√éle-de-Sons</div>
          <div class="brand-subtitle">Biblioth√®que musicale</div>
        </div>

        <div class="stats-pill" id="total-pill" title="Chansons disponibles">
          <div class="stats-label">Chansons dispo</div>
          <div class="stats-value" id="total-songs">‚Äî</div>
        </div>
      </div>

      <div class="search-row">
        <div class="searchbar">
          <span class="search-icon">üîé</span>
          <input
            id="search-input"
            type="text"
            placeholder="Rechercher un titre, artiste, commune, style‚Ä¶"
            autocomplete="off"
          />
          <button id="clear-search" class="clear-btn" aria-label="Effacer">‚úï</button>
        </div>

        <div class="top-actions">
          <button id="btn-filters" class="btn soft">Filtres</button>
          <button id="btn-locate" class="btn soft">Ma position</button>
          <button id="btn-refresh" class="btn soft">Actualiser</button>
        </div>
      </div>

      <div class="status" id="status">Pr√™t.</div>
    </header>

    <!-- MAP -->
    <main class="map-wrap">
      <div id="map" class="map"></div>

      <!-- RESULT DRAWER (only when searching/filtering) -->
      <section id="results-drawer" class="drawer hidden">
        <div class="drawer-head">
          <div class="drawer-title">
            R√©sultats <span class="count-pill" id="results-count">0</span>
          </div>
          <button id="drawer-close" class="icon-btn" aria-label="Fermer">‚úï</button>
        </div>
        <div id="results-list" class="results"></div>
        <div id="no-results" class="empty hidden">Aucun r√©sultat.</div>
      </section>

      <!-- SONG SHEET -->
      <section id="song-sheet" class="sheet hidden">
        <div class="sheet-handle"></div>
        <div class="sheet-content">
          <div class="sheet-top">
            <div>
              <div class="sheet-title" id="sheet-title">Titre</div>
              <div class="sheet-meta" id="sheet-meta">Artiste ‚Ä¢ Ann√©e</div>
              <div class="sheet-place" id="sheet-place">üìç Lieu</div>
            </div>
            <button id="sheet-close" class="icon-btn" aria-label="Fermer">‚úï</button>
          </div>

          <div class="sheet-quote" id="sheet-quote"></div>

          <div class="sheet-actions">
            <button id="sheet-youtube" class="btn primary">YouTube</button>
            <a id="sheet-lyrics" class="btn soft" target="_blank" rel="noopener">Paroles</a>
            <button id="sheet-zoom" class="btn soft">Carte</button>
          </div>
        </div>
      </section>

      <!-- FILTER PANEL -->
      <section id="filters-panel" class="panel hidden" aria-hidden="true">
        <div class="panel-head">
          <div class="panel-title">Recherche avanc√©e</div>
          <button id="filters-close" class="icon-btn" aria-label="Fermer">‚úï</button>
        </div>

        <div class="panel-grid">
          <div class="field">
            <label>Commune</label>
            <select id="f-commune">
              <option value="">Toutes les communes</option>
            </select>
          </div>

          <div class="field">
            <label>Style</label>
            <select id="f-style">
              <option value="">Tous les styles</option>
            </select>
          </div>

          <div class="field">
            <label>Ann√©e (min)</label>
            <input id="f-year-min" type="number" placeholder="ex: 2000" />
          </div>

          <div class="field">
            <label>Ann√©e (max)</label>
            <input id="f-year-max" type="number" placeholder="ex: 2025" />
          </div>

          <div class="field full">
            <label>D√©partement</label>
            <select id="f-dept">
              <option value="">Tous les d√©partements</option>
            </select>
          </div>
        </div>

        <div class="panel-actions">
          <button id="filters-apply" class="btn primary">Appliquer</button>
          <button id="filters-reset" class="btn soft">R√©initialiser</button>
        </div>
      </section>

      <!-- ADD FORM (TAB) -->
      <section id="add-panel" class="add hidden">
        <div class="add-head">
          <div class="add-title">Ajouter une chanson</div>
          <button id="add-close" class="icon-btn" aria-label="Fermer">‚úï</button>
        </div>

        <form id="add-form" class="add-form">
          <div class="field">
            <label>Titre *</label>
            <input id="a-title" required />
          </div>
          <div class="field">
            <label>Artiste *</label>
            <input id="a-artist" required />
          </div>
          <div class="field">
            <label>Commune (lieu) *</label>
            <input id="a-city" required />
          </div>
          <div class="field">
            <label>Style</label>
            <input id="a-style" placeholder="ex: rap, chanson..." />
          </div>
          <div class="field">
            <label>Ann√©e</label>
            <input id="a-year" type="number" placeholder="ex: 2024" />
          </div>
          <div class="field">
            <label>Lien YouTube</label>
            <input id="a-youtube" placeholder="https://www.youtube.com/watch?v=..." />
          </div>
          <div class="field">
            <label>Lien paroles (Genius‚Ä¶)</label>
            <input id="a-lyrics" placeholder="https://..." />
          </div>
          <div class="field">
            <label>Extrait paroles</label>
            <textarea id="a-quote" rows="3" placeholder="Une phrase..."></textarea>
          </div>

          <div class="add-hint">
            Astuce : clique sur la carte pour choisir un point (latitude/longitude).
            <div id="add-coords" class="coords">üìç Coordonn√©es : ‚Äî</div>
          </div>

          <button class="btn primary wide" type="submit">Envoyer pour validation</button>
          <div id="add-status" class="status">‚Äî</div>
        </form>
      </section>

      <!-- BOTTOM NAV -->
      <nav class="bottom-nav">
        <button class="tab active" id="tab-explore">
          <span class="tab-dot"></span> Explorer
        </button>
        <button class="tab" id="tab-library">Biblioth√®que</button>
        <button class="tab" id="tab-add">Ajouter</button>
      </nav>
    </main>
  </div>

  <!-- JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="./app.js"></script>
</body>
</html>

